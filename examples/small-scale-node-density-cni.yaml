tests :
  - name : aws-small-scale-node-density-cni
    metadata:
      platform.keyword: AWS
      masterNodesType.keyword: m6a.xlarge
      masterNodesCount: 3
      workerNodesType.keyword: m6a.xlarge
      workerNodesCount: 6
      infraNodesCount: 3
      benchmark.keyword: node-density-cni
      ocpVersion: "{{ version }}"
      networkType.keyword: OVNKubernetes
      infraNodesType.keyword: r5.xlarge
      not:
        stream: okd
    # encrypted: true
    # fips: false
    # ipsec: false

    metrics : 
    - name:  podReadyLatency
      metricName: podLatencyQuantilesMeasurement
      quantileName: Ready
      metric_of_interest: P99
      not: 
        jobConfig.name: "garbage-collection"
      
    - name:  apiserverCPU
      metricName : containerCPU
      labels.namespace.keyword: openshift-kube-apiserver
      metric_of_interest: value
      agg:
        value: cpu
        agg_type: avg

    - name:  ovnCPU
      metricName : containerCPU
      labels.namespace.keyword: openshift-ovn-kubernetes
      metric_of_interest: value
      agg:
        value: cpu
        agg_type: avg

    - name:  etcdCPU
      metricName : containerCPU
      labels.namespace.keyword: openshift-etcd
      metric_of_interest: value
      agg:
        value: cpu
        agg_type: avg
    
    - name:  etcdDisk
      metricName : 99thEtcdDiskBackendCommitDurationSeconds
      metric_of_interest: value
      agg:
        value: duration
        agg_type: avg

    - name:  ovsCPU-irate-all
      metricName.keyword: cgroupCPU
      labels.id.keyword: /system.slice/ovs-vswitchd.service
      metric_of_interest: value
      agg:
        value: cpu
        agg_type: avg
      direction: 1
      threshold: 10

    - name:  ovsMemory-Workers
      metricName.keyword : cgroupMemoryRSS-Workers
      labels.id.keyword : /system.slice/ovs-vswitchd.service
      metric_of_interest: value
      agg:
        value: mem
        agg_type: max
      direction: 1
      threshold: 10

    - name:  ovsMemory-Masters
      metricName.keyword : cgroupMemoryRSS-Masters
      labels.id.keyword : /system.slice/ovs-vswitchd.service
      metric_of_interest: value
      agg:
        value: mem
        agg_type: max
      direction: 1
      threshold: 10

    - name:  ovsMemory-all
      metricName.keyword: cgroupMemoryRSS
      labels.id.keyword: /system.slice/ovs-vswitchd.service
      metric_of_interest: value
      agg:
        value: mem
        agg_type: avg
      direction: 1
      threshold: 10

